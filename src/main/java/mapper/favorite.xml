<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.favorite">
	<select id="select" parameterType="map"
		resultType="favorite">
		SELECT * FROM favorite WHERE h_fav_no=#{hFNo}
	</select>
	<select id="selectFavList" parameterType="map" resultType="favorite">
		SELECT fav.*,c.category_name, h.h_nm, h.h_address, f.file_no AS hosImgFileNo, f.file_name AS hosImgFileName, f.file_path AS hosImgFilePath
		FROM favorite fav 
		LEFT JOIN hospital h on (h.h_no = fav.hos_no)
		LEFT JOIN hos_category c on (h.category_no = c.category_no)
		LEFT JOIN file f on(h.hos_img_file_no = f.file_no)
		WHERE u_no=#{uNo} 
		LIMIT #{row}, 8
	</select>
	<select id="selectFavCnt" parameterType="Integer" resultType="Integer">
		SELECT COUNT(*) FROM favorite
		WHERE u_no=#{uNo} 
	</select>
	<delete id="delete">
		DELETE FROM favorite WHERE h_fav_no=#{hFNo}
	</delete>
	<!-- 즐겨찾기 등록 -->
	<insert id="insertFav" parameterType="map">
		insert into favorite (u_no, hos_no)
		values (#{uNo}, #{hNo})
	</insert>

	<!-- 즐겨찾기 유지 -->
	<select id="existsFav" parameterType="map" resultType="Integer">
		select
		count(*)
		from favorite
		where u_no = #{uNo} and hos_no=#{hNo}
	</select>

	<!-- 즐겨찾기 삭제 -->
	<delete id="deleteFav" parameterType="map">
		delete from favorite
		where u_no =#{uNo} and hos_no=#{hNo}
	</delete>
</mapper>	